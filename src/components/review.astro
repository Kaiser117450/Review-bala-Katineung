---
import { Image } from 'astro:assets';
import Logo from '../assets/logo.png';

---
<form id="feedbackForm" class="bg-white p-4 rounded-lg shadow-md mx-4 md:mx-auto max-w-md">
      	<div class="flex flex-col items-center mb-12">
      	<Image src={Logo} class="size-16 grayscale opacity-45" alt="" transition:name="logo_awal" />
      	<img src="/logo1.png" alt="">
        <h4 class="logo -mt-2 text-gray-300">Saung Bala Katineung</h4>
      	</div> 
      	    <h2 class="text-3xl font-semibold text-gray-800">Berikan <span class="before:block before:absolute before:-inset-1 before:-skew-y-3 before:-skew-x-3 before:bg-yellow-400 relative inline-block">
 			   <span class="relative text-white">Review</span>
 				 </span>  Anda</h2>
            
            	<div class="rating mb-4 text-gray-200">
                <input type="radio" id="star5" name="rating" value="5">
                <label for="star5">&#9733;</label>
                <input type="radio" id="star4" name="rating" value="4">
                <label for="star4">&#9733;</label>
                <input type="radio" id="star3" name="rating" value="3">
                <label for="star3">&#9733;</label>
                <input type="radio" id="star2" name="rating" value="2">
                <label for="star2">&#9733;</label>
                <input type="radio" id="star1" name="rating" value="1">
                <label for="star1">&#9733;</label>
            </div>

            <hr class="my-8 bg-gray-200 border-t-2">

        <h2 class="text-lg font-semibold text-gray-800 mb-4">Apa yang kamu sukai dari kita</h2>
        <div class="flex flex-wrap gap-2 mb-4 react justify-center transition ease-in-out">
          <label class="option">
            <input type="checkbox" name="reaction" value="kualitas">
            <span class="label-text">‚≠êÔ∏è Kualitas</span>
          </label>
          <label class="option">
            <input type="checkbox" name="reaction" value="rasa">
            <span class="label-text">üòã Rasa</span>
          </label>
          <label class="option">
            <input type="checkbox" name="reaction" value="fresh">
            <span class="label-text">ü•¨ Fresh</span>
          </label>
          <label class="option">
            <input type="checkbox" name="reaction" value="harga">
            <span class="label-text">üí∏ Harga</span>
          </label>
          <label class="option">
            <input type="checkbox" name="reaction" value="porsi">
            <span class="label-text">üçõ Porsi</span>
          </label>
        </div>
            <hr class="my-8 bg-gray-200 border-t-2">

		    <div class="mb-2">
		        <label for="review" class="block text-lg font-semibold text-gray-800">Berikan pendapat kamu dong..</label>
		        <textarea id="comment" name="review" placeholder="Tuliskan review Anda"
		            class="mb-2 peer mt-1 block w-full px-3 py-2 border bg-gray-100 border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 text-gray-900 resize-none h-32"
		            rows="4" maxlength="250" required></textarea>
		            <p id="charCounter" class="text-sm text-gray-500 text-left peer-valid:opacity-100 duration-300 opacity-0 transition ease-in-out">0/250</p>
		            
		    </div>

		    <!-- Tombol Submit -->
		    <button type="submit"
		        class="btn w-full mb-4 peer bg-green-700 hover:bg-green-950 active:bg-gray-500 active:animate-pulse text-white font-semibold py-2 transition duration-300 ease-in-out">
		        <span class="peer-focus:animate-pulse">Submit</span>
		    </button>

		    <p class="disclaimer font-light text-gray-500">Dengan mengirim review kamu dapat membantu kami menjadi lebih baik lagi</p>
        </form>

<style>

.disclaimer {
  font-size: 0.6rem;
}

.logo {
  font-size: 12px;
  font-weight: lighter;
  font-family: Verdana, sans-serif;
  user-select: none;
}

.rating {
    display: flex;
    flex-direction: row-reverse;
    justify-content: center;
}

.rating input {
  display: none;
}

.rating label {
  font-size: 4rem; /* Adjust to fit your layout */
  cursor: pointer;
  padding: 3px;
  user-select: none; 
  background: linear-gradient(to right, grey, whitesmoke); /* Light to dark orange gradient */
  -webkit-background-clip: text; 
  -webkit-text-fill-color: transparent; /* Ensures the gradient fills the text */
}

.rating label:hover,
.rating label:hover ~ label {
  background: linear-gradient(to right, #FFA726, #FB8C00); /* Darker gradient on hover */
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.rating input:checked ~ label {
  background: linear-gradient(to right, #FFA726, #FF6D00); /* Even darker gradient when selected */
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}
.react .option {
    display: inline-flex;
    align-items: center;
    border: 1px solid #ccc;
    border-radius: 9999px;
    padding: 0.5rem 1rem;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  .react .option input {
    display: none;
  }

  .react .option .label-text {
    font-size: 1rem;
    color: #333;
    font-weight: bold;
  }

  .react .option input:checked + .label-text {
    color: white;
  }

.label-text {
  user-select: none; /* Prevents text selection */
}
.btn {
  border-radius: 999px;
}
 
</style>
       

       <script>
  document.addEventListener("DOMContentLoaded", () => {
    const commentBox = document.getElementById("comment");
    const charCounter = document.getElementById("charCounter");

    // Update character count
    commentBox.addEventListener("input", () => {
      const textLength = commentBox.value.length;
      charCounter.textContent = `${textLength}/250`;

      // Basic sanitization to remove unwanted HTML tags
      commentBox.value = commentBox.value.replace(/<[^>]*>?/gm, '');
    });

    // Checkbox toggling for "Apa yang kamu sukai dari kita" section
    const options = document.querySelectorAll(".react .option");
    options.forEach(option => {
      option.addEventListener("click", () => {
        const checkbox = option.querySelector("input");
        checkbox.checked = !checkbox.checked;

        if (checkbox.checked) {
          option.classList.add("bg-green-800", "text-white");
          option.classList.remove("bg-white");
        } else {
          option.classList.remove("bg-green-800", "text-white");
          option.classList.add("bg-white");
        }
      });
    });
  });
</script>

<script>
  import { ReviewFormHandler } from '../scripts/formHandler.js';
  
  document.addEventListener('DOMContentLoaded', () => {
    new ReviewFormHandler('feedbackForm');
  });
</script>